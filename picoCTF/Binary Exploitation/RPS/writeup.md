# RPS
## Description
Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.  
Connect to the program with netcat:  
`$ nc saturn.picoctf.net 56981`  
The program's source code with the flag redacted can be downloaded [here.](game-redacted.c)
## Hints
1. How does the program check if you won?
## Solution
1. Open the source code and start with `main`.
```c
int main () {
  char input[3] = {'\0'};
  int command;
  int r;

  puts("Welcome challenger to the game of Rock, Paper, Scissors");
  puts("For anyone that beats me 5 times in a row, I will offer up a flag I found");
  puts("Are you ready?");
  
  while (true) {
    puts("Type '1' to play a game");
    puts("Type '2' to exit the program");
    r = tgetinput(input, 3);
    // Timeout on user input
    if(r == -3)
    {
      printf("Goodbye!\n");
      exit(0);
    }
    
    if ((command = strtol(input, NULL, 10)) == 0) {
      puts("Please put in a valid number");
      
    } else if (command == 1) {
      printf("\n\n");
      if (play()) {
        wins++;
      } else {
        wins = 0;
      }

      if (wins >= 5) {
        puts("Congrats, here's the flag!");
        puts(flag);
      }
    } else if (command == 2) {
      return 0;
    } else {
      puts("Please type either 1 or 2");
    }
  }

  return 0;
}
```
2. The `win` variable is incremented if `play` returns true. How does `play` work?
```c
bool play () {
  char player_turn[100];
  srand(time(0));
  int r;

  printf("Please make your selection (rock/paper/scissors):\n");
  r = tgetinput(player_turn, 100);
  // Timeout on user input
  if(r == -3)
  {
    printf("Goodbye!\n");
    exit(0);
  }

  int computer_turn = rand() % 3;
  printf("You played: %s\n", player_turn);
  printf("The computer played: %s\n", hands[computer_turn]);

  if (strstr(player_turn, loses[computer_turn])) {
    puts("You win! Play again?");
    return true;
  } else {
    puts("Seems like you didn't win this time. Play again?");
    return false;
  }
}
```
3. The game determines if you win by checking if a string in `loses` is contained in `player_turn` using the function `strstr`. If there is no match, then you lose. What if we feed the game an input containing each member of the array `loses`?
```console
% nc saturn.picoctf.net 56981
Welcome challenger to the game of Rock, Paper, Scissors
For anyone that beats me 5 times in a row, I will offer up a flag I found
Are you ready?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paperscissorsrock
paperscissorsrock
You played: paperscissorsrock
The computer played: paper
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paperscissorsrock
paperscissorsrock
You played: paperscissorsrock
The computer played: paper
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paperscissorsrock
paperscissorsrock
You played: paperscissorsrock
The computer played: scissors
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paperscissorsrock
paperscissorsrock
You played: paperscissorsrock
The computer played: paper
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paperscissorsrock
paperscissorsrock
You played: paperscissorsrock
The computer played: scissors
You win! Play again?
Congrats, here's the flag!
picoCTF{50M3_3X7R3M3_1UCK_C85AF58A}
Type '1' to play a game
Type '2' to exit the program
Timed out waiting for user input. Press Ctrl-C to disconnect
Goodbye!
```